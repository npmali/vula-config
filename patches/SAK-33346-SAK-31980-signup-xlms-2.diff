Index: signup/pom.xml
===================================================================
--- signup/pom.xml	(revision 47577)
+++ signup/pom.xml	(working copy)
@@ -137,6 +137,11 @@
 				<version>${sakai.poi.version}</version>
 				<scope>compile</scope>
 			</dependency>
+            <dependency>
+				<groupId>org.apache.poi</groupId>
+				<artifactId>poi-ooxml</artifactId>
+				<version>${sakai.poi.version}</version>
+			</dependency>
 			<dependency>
 				<groupId>javax.servlet</groupId>
 				<artifactId>jstl</artifactId>
Index: signup/tool/pom.xml
===================================================================
--- signup/tool/pom.xml	(revision 47577)
+++ signup/tool/pom.xml	(working copy)
@@ -112,6 +112,11 @@
             <artifactId>poi</artifactId>
         </dependency>
         <dependency>
+           <groupId>org.apache.poi</groupId>
+           <artifactId>poi-ooxml</artifactId>
+		</dependency>
+
+        <dependency>
             <groupId>javax.servlet</groupId>
             <artifactId>jstl</artifactId>
             <scope>provided</scope>
Index: signup/tool/src/java/org/sakaiproject/signup/tool/downloadEvents/DownloadEventBean.java
===================================================================
--- signup/tool/src/java/org/sakaiproject/signup/tool/downloadEvents/DownloadEventBean.java	(revision 47577)
+++ signup/tool/src/java/org/sakaiproject/signup/tool/downloadEvents/DownloadEventBean.java	(working copy)
@@ -57,7 +57,7 @@
 
 	private static final String FROM_ORGANIZER_EVENT_PAGE = "orgSignupMeeting";
 
-	private static final String DOWNLOAD_EVENT_DETAILS_XLS_FILE_NAME = "EventsWorksheet.xls";
+	private static final String DOWNLOAD_EVENT_DETAILS_XLS_FILE_NAME = "EventsWorksheet.xlsx";
 	
 	private static final String DOWNLOAD_EVENT_DETAILS_CSV_FILE_NAME = "EventsWorksheet.csv";
 	
Index: signup/tool/src/java/org/sakaiproject/signup/tool/downloadEvents/EventWorksheet.java
===================================================================
--- signup/tool/src/java/org/sakaiproject/signup/tool/downloadEvents/EventWorksheet.java	(revision 47577)
+++ signup/tool/src/java/org/sakaiproject/signup/tool/downloadEvents/EventWorksheet.java	(working copy)
@@ -21,7 +21,7 @@
 
 import org.apache.poi.ss.util.CellRangeAddress;
 import org.apache.poi.ss.usermodel.*;
-import org.apache.poi.hssf.usermodel.HSSFHyperlink;
+import org.apache.poi.common.usermodel.HyperlinkType;
 import org.apache.poi.hssf.usermodel.HSSFWorkbook;
 import org.sakaiproject.exception.IdUnusedException;
 import org.sakaiproject.signup.logic.SakaiFacade;
@@ -32,7 +32,6 @@
 import org.sakaiproject.signup.model.SignupMeeting;
 import org.sakaiproject.signup.model.SignupSite;
 import org.sakaiproject.signup.model.SignupTimeslot;
-import org.sakaiproject.signup.tool.jsf.HtmlSortHeaderRenderer;
 import org.sakaiproject.signup.tool.jsf.SignupMeetingWrapper;
 import org.sakaiproject.signup.tool.util.SignupBeanConstants;
 import org.sakaiproject.site.api.Site;
@@ -40,6 +39,8 @@
 
 import org.sakaiproject.user.api.User;
 import org.sakaiproject.util.ResourceLoader;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
 
 import java.text.SimpleDateFormat;
 import java.util.ArrayList;
@@ -51,6 +52,16 @@
 import java.util.HashMap;
 import java.util.Iterator;
 
+import org.apache.poi.ss.usermodel.Cell;
+import org.apache.poi.ss.usermodel.CellStyle;
+import org.apache.poi.ss.usermodel.CreationHelper;
+import org.apache.poi.ss.usermodel.Hyperlink;
+import org.apache.poi.ss.usermodel.PrintSetup;
+import org.apache.poi.ss.usermodel.Row;
+import org.apache.poi.ss.usermodel.Sheet;
+import org.apache.poi.ss.usermodel.Workbook;
+import org.apache.poi.xssf.usermodel.XSSFWorkbook;
+
 /*
  * <p> This class will provides formatting data to Excel style functionality.
  * </P>
@@ -61,6 +72,8 @@
 
 	private ResourceLoader rb = new ResourceLoader("messages");
 
+	private static Logger log = LoggerFactory.getLogger(EventWorksheet.class);
+	
 	private String[] tabTitles_Organizor;
 
 	private String[] tabTitles_Participant;
@@ -89,9 +102,10 @@
 	 */
 	public EventWorksheet(SakaiFacade sakaiFacade) {
 		this.sakaiFacade = sakaiFacade;
-		wb = new HSSFWorkbook();
-		/* could also define wb = new XSSFWorkbook(); */
 
+		wb = new XSSFWorkbook();
+
+
 		styles = WorksheetStyleClass.createStyles(wb);
 
 		dateFormat = new SimpleDateFormat("", rb.getLocale());
@@ -410,7 +424,7 @@
 				cell = row.getCell(0);
 				cell.setCellStyle(styles.get("item_left_wrap"));
 				cell.setCellValue(wrp.getMeeting().getTitle());
-				Hyperlink sheetLink = createHelper.createHyperlink(Hyperlink.LINK_DOCUMENT);
+				Hyperlink sheetLink = createHelper.createHyperlink(HyperlinkType.FILE);
 				String validSheetName = CreateValidWorksheetName(wrp.getMeeting().getTitle(), seqNum, true);
 				String hlinkAddr = "'" + validSheetName + "'" + "!A1";
 				sheetLink.setAddress(hlinkAddr);
@@ -488,13 +502,15 @@
 		// timezone row
 		Row timezoneRow = sheet.createRow(1);
 		timezoneRow.setHeightInPoints(16);
+		log.info("timezoneRow");
 		for (int i = 1; i <= 7; i++) {
+			log.info("timezone: " + i);
 			timezoneRow.createCell(i).setCellStyle(styles.get("tabItem_fields"));
 		}
 		Cell timezoneCell = timezoneRow.getCell(2);
-		timezoneCell.setCellValue("(" + rb.getString("event_timezone") + " " + sakaiFacade.getTimeService().getLocalTimeZone().getID() + ")");
+		timezoneCell.setCellValue("(" + rb.getString("event_timezone") + " " + sakaiFacade.getTimeService().getLocalTimeZone().getID() + ")");		
 		sheet.addMergedRegion(CellRangeAddress.valueOf("$C$2:$H$2"));
-
+		
 		// owner row
 		Row row = sheet.createRow(2);
 		row.setHeightInPoints(rowHigh);
@@ -1063,8 +1079,8 @@
 		return title;
 	}
 
-	private HSSFHyperlink setAttachmentURLLinks(SignupAttachment attach) {
-		HSSFHyperlink hsHyperlink = new HSSFHyperlink(HSSFHyperlink.LINK_URL);
+	private Hyperlink setAttachmentURLLinks(SignupAttachment attach) {
+		Hyperlink hsHyperlink = wb.getCreationHelper().createHyperlink(HyperlinkType.URL);
 		String link = this.sakaiFacade.getServerConfigurationService().getServerUrl()
 				+ attach.getLocation();
 		hsHyperlink.setAddress(link);
Index: signup/tool/src/java/org/sakaiproject/signup/tool/downloadEvents/WorksheetStyleClass.java
===================================================================
--- signup/tool/src/java/org/sakaiproject/signup/tool/downloadEvents/WorksheetStyleClass.java	(revision 47577)
+++ signup/tool/src/java/org/sakaiproject/signup/tool/downloadEvents/WorksheetStyleClass.java	(working copy)
@@ -22,9 +22,13 @@
 import java.util.HashMap;
 import java.util.Map;
 
+import org.apache.poi.ss.usermodel.BorderStyle;
 import org.apache.poi.ss.usermodel.CellStyle;
+import org.apache.poi.ss.usermodel.FillPatternType;
 import org.apache.poi.ss.usermodel.Font;
+import org.apache.poi.ss.usermodel.HorizontalAlignment;
 import org.apache.poi.ss.usermodel.IndexedColors;
+import org.apache.poi.ss.usermodel.VerticalAlignment;
 import org.apache.poi.ss.usermodel.Workbook;
 
 /**
@@ -37,23 +41,25 @@
 	public static Map<String, CellStyle> createStyles(Workbook wb) {
 		Map<String, CellStyle> styles = new HashMap<String, CellStyle>();
 		CellStyle style;
+		
+		//Title
 		Font titleFont = wb.createFont();
 		titleFont.setFontHeightInPoints((short) 18);
-		titleFont.setBoldweight(Font.BOLDWEIGHT_BOLD);
+		titleFont.setBold(true);
 		titleFont.setColor(IndexedColors.DARK_BLUE.getIndex());
 		style = wb.createCellStyle();
-		style.setAlignment(CellStyle.ALIGN_CENTER);
-		style.setVerticalAlignment(CellStyle.VERTICAL_CENTER);
+		style.setAlignment(HorizontalAlignment.CENTER);
+		style.setVerticalAlignment(VerticalAlignment.CENTER);
 		style.setFont(titleFont);
 		styles.put("title", style);
 
 		Font commentTitleFont = wb.createFont();
 		commentTitleFont.setFontHeightInPoints((short) 12);
-		commentTitleFont.setBoldweight(Font.BOLDWEIGHT_BOLD);
+		commentTitleFont.setBold(true);
 		commentTitleFont.setColor(IndexedColors.DARK_BLUE.getIndex());
 		style = wb.createCellStyle();
-		style.setAlignment(CellStyle.ALIGN_LEFT);
-		style.setVerticalAlignment(CellStyle.VERTICAL_CENTER);
+		style.setAlignment(HorizontalAlignment.LEFT);
+		style.setVerticalAlignment(VerticalAlignment.CENTER);
 		style.setFont(commentTitleFont);
 		styles.put("commentTitle", style);
 
@@ -61,20 +67,20 @@
 		itemFont.setFontHeightInPoints((short) 10);
 		itemFont.setFontName("Trebuchet MS");
 		style = wb.createCellStyle();
-		style.setAlignment(CellStyle.ALIGN_LEFT);
+		style.setAlignment(HorizontalAlignment.LEFT);
 		style.setFont(itemFont);
 		styles.put("item_left", style);
 
-		style = wb.createCellStyle();
-		style.setAlignment(CellStyle.ALIGN_LEFT);
-		style.setVerticalAlignment(CellStyle.VERTICAL_CENTER);
+		style = wb.createCellStyle();;
+		style.setAlignment(HorizontalAlignment.LEFT);
+		style.setVerticalAlignment(VerticalAlignment.CENTER);
 		style.setFont(itemFont);
 		style.setWrapText(true);
 		styles.put("item_left_wrap", style);
 
 		style = wb.createCellStyle();
-		style.setAlignment(CellStyle.ALIGN_LEFT);
-		style.setVerticalAlignment(CellStyle.VERTICAL_TOP);
+		style.setAlignment(HorizontalAlignment.LEFT);
+		style.setVerticalAlignment(VerticalAlignment.TOP);
 		style.setFont(itemFont);
 		style.setWrapText(true);
 		styles.put("item_left_wrap_top", style);
@@ -82,19 +88,19 @@
 		itemFont.setFontHeightInPoints((short) 10);
 		itemFont.setFontName("Trebuchet MS");
 		style = wb.createCellStyle();
-		style.setAlignment(CellStyle.ALIGN_CENTER);
-		style.setVerticalAlignment(CellStyle.VERTICAL_CENTER);
+		style.setAlignment(HorizontalAlignment.CENTER);
+		style.setVerticalAlignment(VerticalAlignment.CENTER);
 		style.setFont(itemFont);
 		styles.put("tabItem_fields", style);
 
 		style = wb.createCellStyle();
-		style.setAlignment(CellStyle.ALIGN_RIGHT);
+		style.setAlignment(HorizontalAlignment.RIGHT);
 		style.setFont(itemFont);
 		styles.put("item_right", style);
 
 		style = wb.createCellStyle();
-		style.setAlignment(CellStyle.ALIGN_CENTER);
-		style.setVerticalAlignment(CellStyle.VERTICAL_CENTER);
+		style.setAlignment(HorizontalAlignment.CENTER);
+		style.setVerticalAlignment(VerticalAlignment.CENTER);
 		style.setFont(itemFont);
 		style.setWrapText(true);
 		styles.put("attendee_layout", style);
@@ -104,9 +110,9 @@
 		itemBoldFont.setFontName("Trebuchet MS");
 		itemBoldFont.setColor(IndexedColors.DARK_BLUE.getIndex());
 		style = wb.createCellStyle();
-		style.setAlignment(CellStyle.ALIGN_LEFT);
-		style.setVerticalAlignment(CellStyle.VERTICAL_TOP);
-		itemBoldFont.setBoldweight(Font.BOLDWEIGHT_BOLD);
+		style.setAlignment(HorizontalAlignment.LEFT);
+		style.setVerticalAlignment(VerticalAlignment.TOP);
+		itemBoldFont.setBold(true);
 		style.setFont(itemBoldFont);
 		styles.put("item_leftBold", style);
 
@@ -113,12 +119,12 @@
 		Font tableFont = wb.createFont();
 		tableFont.setFontHeightInPoints((short) 12);
 		tableFont.setColor(IndexedColors.WHITE.getIndex());
-		tableFont.setBoldweight(Font.BOLDWEIGHT_BOLD);
+		tableFont.setBold(true);
 		style = wb.createCellStyle();
-		style.setAlignment(CellStyle.ALIGN_CENTER);
-		style.setVerticalAlignment(CellStyle.VERTICAL_CENTER);
+		style.setAlignment(HorizontalAlignment.CENTER);
+		style.setVerticalAlignment(VerticalAlignment.CENTER);
 		style.setFillForegroundColor(IndexedColors.DARK_BLUE.getIndex());
-		style.setFillPattern(CellStyle.SOLID_FOREGROUND);
+		style.setFillPattern(FillPatternType.SOLID_FOREGROUND);
 		style.setFont(tableFont);
 		styles.put("tabColNames", style);
 
@@ -125,10 +131,10 @@
 		tableFont.setFontHeightInPoints((short) 10);
 		tableFont.setColor(IndexedColors.WHITE.getIndex());
 		style = wb.createCellStyle();
-		style.setAlignment(CellStyle.ALIGN_CENTER);
-		style.setVerticalAlignment(CellStyle.VERTICAL_CENTER);
+		style.setAlignment(HorizontalAlignment.CENTER);
+		style.setVerticalAlignment(VerticalAlignment.CENTER);
 		style.setFillForegroundColor(IndexedColors.GREY_50_PERCENT.getIndex());
-		style.setFillPattern(CellStyle.SOLID_FOREGROUND);
+		style.setFillPattern(FillPatternType.SOLID_FOREGROUND);
 		style.setFont(tableFont);
 		style.setWrapText(true);
 		styles.put("header", style);
@@ -138,13 +144,13 @@
 		linkFont.setColor(IndexedColors.BLUE.getIndex());
 		linkFont.setUnderline(Font.U_SINGLE);
 		style = wb.createCellStyle();
-		style.setAlignment(CellStyle.ALIGN_LEFT);
-		style.setVerticalAlignment(CellStyle.VERTICAL_CENTER);
+		style.setAlignment(HorizontalAlignment.LEFT);
+		style.setVerticalAlignment(VerticalAlignment.CENTER);
 		style.setFont(linkFont);
 		styles.put("hyperLink", style);
 
 		style = wb.createCellStyle();
-		style.setBorderTop(CellStyle.BORDER_THICK);
+		style.setBorderTop(BorderStyle.THIN);
 		style.setTopBorderColor(IndexedColors.DARK_BLUE.getIndex());
 		styles.put("tab_endline", style);
 
